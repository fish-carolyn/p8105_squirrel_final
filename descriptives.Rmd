---
title: "Squirreling the Stats: A Demographic Tale"
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, message = FALSE)
```

```{r}
library(tidyverse)
library(plotly)
```

#### In this section, we will be looking at squirrel demographics, such as fur color and age. 

First, we will import the cleaned squirrel data. 

```{r}
squirrel_census = 
  read_csv("data/clean_squirrel_2018.csv") |> 
  janitor::clean_names()
```

There are a total of `r nrow(squirrel_census)` squirrel observations in the data set. 


#### Let's first explore squirrel ages. 

```{r}
squirrel_census |> 
  filter(!(age %in% c("N/A", "?"))) |> 
  group_by(age) |> 
  count(age) |> 
  mutate(Age = fct_reorder(age, n)) |> 
  plot_ly (x = ~age, y = ~n, color = ~age,
         type = "bar") |> 
  layout(
    xaxis = list(title = "Age"),   
    yaxis = list(title = "Number of Squirrels") 
  )
```
It appears that the majority of observed squirrels are adults. There are 2503 adult squirrels in the data set and only 319 juvenile squirrels. 


#### Let's also look at primary and highlight fur color.

```{r}
squirrel_census |> 
  filter(!(combination_of_primary_and_highlight_color %in% c("N/A", "?"))) |> 
  group_by(primary_fur_color) |> 
  count(primary_fur_color) |> 
  mutate(primary_fur_color = fct_reorder(primary_fur_color, n)) |> 
  plot_ly (x = ~primary_fur_color, y = ~n, color = ~primary_fur_color,
         type = "bar", colors = "viridis") |> 
  layout(
    xaxis = list(title = "Primary Fur Color"),   
    yaxis = list(title = "Number of Squirrels") 
  )
```

```{r}
squirrel_census |> 
  rename(combination_fur_color = combination_of_primary_and_highlight_color) |> 
  count(combination_fur_color) |> 
  mutate(combination_fur_color = fct_reorder(combination_fur_color, n)) |> 
  plot_ly (x = ~combination_fur_color, y = ~n, color = ~combination_fur_color,
         type = "bar", colors = "viridis") |> 
  layout(
    xaxis = list(title = "Fur Color"),   
    yaxis = list(title = "Number of Squirrels") 
  )
```

#### Is there a difference in primary fur color depending on age? 

```{r}
squirrel_census |> 
  filter(!(age %in% c("N/A", "?"))) |>
  select(age, primary_fur_color) |> 
  group_by(age, primary_fur_color) |> 
  summarise(count = n()) |> 
  mutate(percent = count / sum(count) * 100) |> 
  plot_ly (x = ~age, y = ~percent, color = ~primary_fur_color,
         type = "bar", colors = "viridis") |> 
  layout(
    xaxis = list(title = "Age"),   
    yaxis = list(title = "Percent of Squirrels") 
  )
```

#### Here is a map of squirrel location based on primary fur color. 

```{r squirrel_fur_plot_test}
squirrel_fur_graph =
  squirrel_census |> 
  select(unique_squirrel_id, x, y, primary_fur_color) |>
  filter(!is.na(primary_fur_color))
        
squirrel_fur_graph |> 
  plot_ly(x = ~x, y = ~y, type = "scatter", mode = "markers", color = ~primary_fur_color)

#you don't have to use this but wanted you to take a look
```