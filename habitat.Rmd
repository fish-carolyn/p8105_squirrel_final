---
title: "Nesting Nooks: Exploring Squirrel Habitat"
output: 
  html_document:
    code_folding: hide
    always_allow_html: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(collapse = TRUE, message = FALSE)
```

```{r, include = FALSE}
library(tidyverse)
library(plotly)
library(ggplot2)
library(sf)
library(dplyr)
library(patchwork)
library(leaflet)
library(modelr)
```

Here we are loading in the data and a shapefile of Central Park!

```{r}
squirrel_census = 
  read_csv("data/clean_squirrel_2018.csv")

central_park_map = st_read(here::here('central_park', 'CentralPark.shp'), quiet = TRUE)
```

#### Let's see where all the hungry squirrels are in Central Park!
```{r}
leaflet() |>  
  addTiles() |>  
  addCircleMarkers(data = squirrel_census,
             lng = ~x,
             lat = ~y,
             label = ~name,
             radius = 1,
             color = "coral",
             stroke = TRUE, fillOpacity = 0.75,
             popup = ~paste("Name:", name,
                            "<br> Eating:", eating)) |> 
  addProviderTiles(providers$CartoDB.Positron)
```


#### If they aren't eating, they are doing some other activity...

```{r, fig.width= 10, fig.align='center'}
squirrel_census |> 
  mutate(
    activity = case_when(
      running == "TRUE" ~ "running",
      chasing == "TRUE" ~ "chasing",
      climbing == "TRUE" ~ "climbing",
      foraging == "TRUE" ~ "foraging",
      .default = "sedentary"
    )
  ) |> 
  filter(activity != "sedentary") |> 
  ggplot() +
    geom_sf(data = central_park_map, color = "grey") +
  geom_point(
    aes(x = x, y = y, color = activity),
    size = 0.5, alpha = 0.75) +
    theme_void(base_size = 15) +
  theme(legend.position = 'bottom') +
  guides(color = guide_legend(
    title.position = "top",
    override.aes = list(size = 3))) +
  labs(
    title = "What are they doing?",
    color = "Squirrel Activities"
  ) +
  facet_grid(cols = vars(activity))
```


#### Where should one look to spot our furry friends?

```{r, fig.width= 6, fig.align='center'}
squirrel_census |> 
  ggplot() +
  geom_sf(data = central_park_map, color = "grey") +
  geom_point(
    aes(x = x, y = y, color = location),
    size = 0.5, alpha = 0.75) +
    theme_void(base_size = 15) +
  theme(legend.position = 'bottom') +
  guides(color = guide_legend(
    title.position = "top",
    override.aes = list(size = 3))) +
  labs(title = 'Up High or Down Low?',
       color = "Location")
```
